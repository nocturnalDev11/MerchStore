@page "/checkout"

<div class="mx-auto">
    <h1 class="text-4xl font-bold text-gray-800 mb-6 text-center">Checkout</h1>
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
        <div class="bg-white rounded-lg shadow-lg p-6">
            <h2 class="text-2xl font-semibold text-gray-800 mb-4">Customer Details</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                <div>
                    <label class="block text-sm font-medium text-gray-700">First Name *</label>
                    <input type="text" class="mt-1 w-full border border-gray-300 rounded-lg p-3 focus:ring-2 focus:ring-blue-500" placeholder="John">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700">Last Name *</label>
                    <input type="text" class="mt-1 w-full border border-gray-300 rounded-lg p-3 focus:ring-2 focus:ring-blue-500" placeholder="Doe">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700">Email *</label>
                    <input type="email" class="mt-1 w-full border border-gray-300 rounded-lg p-3 focus:ring-2 focus:ring-blue-500" placeholder="johndoe@example.com">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700">Phone Number *</label>
                    <input type="tel" class="mt-1 w-full border border-gray-300 rounded-lg p-3 focus:ring-2 focus:ring-blue-500" placeholder="+63 969 123 4567">
                </div>
            </div>

            <h2 class="text-2xl font-semibold text-gray-800 mb-4 mt-6">Shipping Details</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div class="md:col-span-2">
                    <label class="block text-sm font-medium text-gray-700">Address *</label>
                    <input type="text" class="mt-1 w-full border border-gray-300 rounded-lg p-3 focus:ring-2 focus:ring-blue-500" placeholder="Purok 5, Upper Bicutan">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700">City *</label>
                    <input type="text" class="mt-1 w-full border border-gray-300 rounded-lg p-3 focus:ring-2 focus:ring-blue-500" placeholder="Taguig City">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700">State *</label>
                    <input type="text" class="mt-1 w-full border border-gray-300 rounded-lg p-3 focus:ring-2 focus:ring-blue-500" placeholder="NCR, Philippines">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700">Postal Code *</label>
                    <input type="text" class="mt-1 w-full border border-gray-300 rounded-lg p-3 focus:ring-2 focus:ring-blue-500" placeholder="1633">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700">Country *</label>
                    <select class="mt-1 w-full border border-gray-300 rounded-lg p-3 focus:ring-2 focus:ring-blue-500">
                        <option>Philippines</option>
                        <option>USA</option>
                        <option>Canada</option>
                    </select>
                </div>
            </div>

            <h2 class="text-2xl font-semibold text-gray-800 mt-6 mb-4">Payment Method</h2>
            <div class="space-y-3 grid grid-cols-1 md:grid-cols-3 gap-4">
                <label class="flex items-center">
                    <input type="radio" name="payment" class="h-5 w-5 text-blue-600 focus:ring-2 focus:ring-blue-500">
                    <span class="ml-2 text-gray-700">GCash</span>
                </label>
                <label class="flex items-center">
                    <input type="radio" name="payment" class="h-5 w-5 text-blue-600 focus:ring-2 focus:ring-blue-500">
                    <span class="ml-2 text-gray-700">GoTyme</span>
                </label>
                <label class="flex items-center">
                    <input type="radio" name="payment" class="h-5 w-5 text-blue-600 focus:ring-2 focus:ring-blue-500">
                    <span class="ml-2 text-gray-700">Maya</span>
                </label>
                <label class="flex items-center">
                    <input type="radio" name="payment" class="h-5 w-5 text-blue-600 focus:ring-2 focus:ring-blue-500">
                    <span class="ml-2 text-gray-700">Paypal</span>
                </label>
                <label class="flex items-center">
                    <input type="radio" name="payment" class="h-5 w-5 text-blue-600 focus:ring-2 focus:ring-blue-500" checked>
                    <span class="ml-2 text-gray-700">Credit or Debit Card</span>
                </label>
                <label class="flex items-center">
                    <input type="radio" name="payment" class="h-5 w-5 text-blue-600 focus:ring-2 focus:ring-blue-500">
                    <span class="ml-2 text-gray-700">COD</span>
                </label>
            </div>
            <div class="mt-4 grid grid-cols-1 md:grid-cols-3 gap-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700">Card Number *</label>
                    <input type="text" class="mt-1 w-full border border-gray-300 rounded-lg p-3 focus:ring-2 focus:ring-blue-500" placeholder="XXXX XXXX XXXX 4568">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700">Expiry Date *</label>
                    <input type="text" class="mt-1 w-full border border-gray-300 rounded-lg p-3 focus:ring-2 focus:ring-blue-500" placeholder="08/2027">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700">CVV *</label>
                    <input type="text" class="mt-1 w-full border border-gray-300 rounded-lg p-3 focus:ring-2 focus:ring-blue-500" placeholder="000">
                </div>
            </div>
        </div>

        <div class="bg-white rounded-lg shadow-lg p-6">
            <h2 class="text-2xl font-semibold text-gray-800 mb-4">Order Summary</h2>
            <div class="space-y-4">
                <div class="flex items-center justify-between border-b border-gray-300 py-3">
                    <div class="flex items-center">
                        <img src="images/shirt-7.webp" alt="Product" class="w-35 h-35 object-cover rounded mr-4">
                        <div>
                            <h3 class="text-sm font-medium text-gray-800">Software Engineer Shirt</h3>
                            <p class="text-lg text-green-600">₱549.00</p>

                            <div class="flex items-center pt-5">
                                <button class="text-gray-600 hover:text-gray-800">
                                    <span class="material-symbols-outlined">remove</span>
                                </button>

                                <input type="number" value="1" min="1" class="w-12 text-center border border-gray-300 rounded mx-2">

                                <button class="text-gray-600 hover:text-gray-800">
                                    <span class="material-symbols-outlined">add</span>
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="flex items-center">
                        <button class="text-red-500 hover:text-red-700 ml-2">
                            <span class="material-symbols-outlined">close</span>
                        </button>
                    </div>
                </div>
                <div class="flex items-center justify-between border-b border-gray-300 py-3">
                    <div class="flex items-center">
                        <img src="images/shirt-1.webp" alt="Product" class="w-35 h-35 object-cover rounded mr-4">
                        <div>
                            <h3 class="text-sm font-medium text-gray-800">Software Developer Shirt</h3>
                            <p class="text-lg text-green-600">₱499.00</p>

                            <div class="flex items-center pt-5">
                                <button class="text-gray-600 hover:text-gray-800">
                                    <span class="material-symbols-outlined">remove</span>
                                </button>

                                <input type="number" value="1" min="1" class="w-12 text-center border border-gray-300 rounded mx-2">

                                <button class="text-gray-600 hover:text-gray-800">
                                    <span class="material-symbols-outlined">add</span>
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="flex items-center">
                        <button class="text-red-500 hover:text-red-700 ml-2">
                            <span class="material-symbols-outlined">close</span>
                        </button>
                    </div>
                </div>
            </div>
            <div class="mt-6">
                <label class="block text-sm font-medium text-gray-700">Discount Code</label>
                <div class="flex-col space-y-2">
                    <input type="text" class="mt-1 w-full border border-gray-300 rounded-lg p-3 focus:ring-2 focus:ring-blue-500" placeholder="WELCOME123">
                    <button class="flex items-center justify-center bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700">
                        <span class="material-symbols-outlined">check</span>
                        <span class="ms-3">Apply</span>
                    </button>
                </div>
            </div>
            <div class="mt-6 space-y-2">
                <div class="flex justify-between">
                    <p class="text-gray-700">Subtotal</p>
                    <p class="font-semibold text-gray-800">₱1,048.00</p>
                </div>
                <div class="flex justify-between">
                    <p class="text-gray-700">Shipping Charge</p>
                    <p class="font-semibold text-gray-800">₱20.00</p>
                </div>
                <div class="flex justify-between">
                    <p class="text-gray-700">Taxes</p>
                    <p class="font-semibold text-gray-800">₱22.00</p>
                </div>
                <div class="flex justify-between">
                    <p class="text-gray-700">Discount</p>
                    <p class="font-semibold text-red-600">-₱12.00</p>
                </div>
                <div class="flex justify-between text-lg font-bold">
                    <p>Total</p>
                    <p class="text-green-600">₱1,078.00</p>
                </div>
            </div>
            <button class="flex items-center justify-center mt-6 w-full bg-blue-600 text-white py-3 rounded-lg hover:bg-blue-700">
                <span class="material-symbols-outlined mr-2">shopping_cart_checkout</span> Checkout
            </button>
        </div>
    </div>
</div>

@code {
    private CustomerDetails customer = new();
    private ShippingDetails shipping = new();
    private string selectedPaymentMethod = "Credit or Debit Card";
    private string cardNumber, expiryDate, cvv;
    private string discountCode;
    private decimal appliedDiscount = 0;
    private string discountMessage;

    private List<CartItem> cart = new()
    {
        new() { Name = "Software Engineer Shirt", Price = 549, ImageUrl = "images/shirt-7.webp", Quantity = 1 },
        new() { Name = "Software Developer Shirt", Price = 499, ImageUrl = "images/shirt-1.webp", Quantity = 1 }
    };

    private void IncreaseQty(CartItem item) => item.Quantity++;
    private void DecreaseQty(CartItem item) { if (item.Quantity > 1) item.Quantity--; }
    private void RemoveItem(CartItem item) => cart.Remove(item);
    private decimal Subtotal => cart.Sum(i => i.Price * i.Quantity);
    private decimal Discount => appliedDiscount;
    private decimal Shipping => 20;
    private decimal Tax => 22;
    private decimal Total => Subtotal + Shipping + Tax - Discount;

    private void ApplyDiscount()
    {
        if (!string.IsNullOrWhiteSpace(discountCode))
        {
            if (discountCode.ToLower() == "dev20")
            {
                appliedDiscount = 20;
                discountMessage = "₱20 discount applied!";
            }
            else if (discountCode.ToLower() == "freebie")
            {
                appliedDiscount = Subtotal >= 1000 ? 50 : 0;
                discountMessage = appliedDiscount > 0 ? "₱50 discount for orders over ₱1000!" : "Subtotal too low for 'freebie' code.";
            }
            else
            {
                appliedDiscount = 0;
                discountMessage = "Invalid discount code.";
            }
        }
        else
        {
            discountMessage = "Please enter a discount code.";
        }
    }

    private void SubmitOrder() => Console.WriteLine("Order submitted!");

    public class CustomerDetails
    {
        public string FirstName { get; set; }
        public string LastName { get; set; }
        public string Email { get; set; }
        public string Phone { get; set; }
    }

    public class ShippingDetails
    {
        public string Address { get; set; }
        public string City { get; set; }
        public string State { get; set; }
        public string PostalCode { get; set; }
        public string Country { get; set; } = "Philippines";
    }

    public class CartItem
    {
        public string Name { get; set; }
        public decimal Price { get; set; }
        public string ImageUrl { get; set; }
        public int Quantity { get; set; }
    }
}
